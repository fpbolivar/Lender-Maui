<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
                      xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                      x:Class="Lender.LoginPage"
                      Title="Lender"
                      BackgroundColor="#0A1929"
                      Padding="0"
                      SafeAreaEdges="None">

       <ContentPage.Resources>
              <ResourceDictionary>
                     <Color x:Key="DarkBg">#0A1929</Color>
                     <Color x:Key="CardBg">#132F4C</Color>
                     <Color x:Key="AccentOrange">#FF9F43</Color>
                     <Color x:Key="TextLight">#B0BEC5</Color>
                     <Color x:Key="TextWhite">#FFFFFF</Color>
                     <Color x:Key="ErrorRed">#EF4444</Color>
              </ResourceDictionary>
       </ContentPage.Resources>

       <Grid RowDefinitions="*" Padding="0" BackgroundColor="{StaticResource DarkBg}" SafeAreaEdges="None">
              <!-- Top Right Demo Mode Button (Absolute Positioning) -->
              <Button Text="See demo mode"
                      Command="{Binding DemoModeCommand}"
                      BackgroundColor="{StaticResource CardBg}"
                      TextColor="{StaticResource AccentOrange}"
                      CornerRadius="12"
                      Padding="12,8"
                      FontAttributes="Bold"
                      FontSize="12"
                      HorizontalOptions="End"
                      VerticalOptions="Start"
                      Margin="0,60,20,0"
                      ZIndex="100" />
              
              <ScrollView Grid.Row="0" BackgroundColor="{StaticResource DarkBg}" HorizontalOptions="Fill" VerticalOptions="Fill">
                     <VerticalStackLayout Padding="20,60,20,20" Spacing="12">

                            <VerticalStackLayout Spacing="4" HorizontalOptions="Center" Margin="0,0,0,12">
                                   <Label Text="Lender"
                                             FontSize="40"
                                             FontAttributes="Bold"
                                             TextColor="{StaticResource AccentOrange}"
                                             HorizontalTextAlignment="Center" />
                                   <Label Text="Peer-to-Peer Lending"
                                             FontSize="14"
                                             TextColor="{StaticResource TextLight}"
                                             HorizontalTextAlignment="Center" />
                            </VerticalStackLayout>

                     <HorizontalStackLayout Spacing="0" HorizontalOptions="Center" Margin="0,0,0,12">
                              <Label Text="Sign In" FontSize="14" FontAttributes="Bold" TextColor="{StaticResource AccentOrange}" Margin="0,0,20,0"
                                     IsVisible="{Binding IsSignUp, Converter={StaticResource InvertedBoolConverter}}" />
                              <Label Text="Sign Up" FontSize="14" FontAttributes="Bold" TextColor="{StaticResource AccentOrange}" Margin="0,0,20,0"
                                     IsVisible="{Binding IsSignUp}" />
                            <Label Text="â€¢" TextColor="{StaticResource TextLight}" />
                              <Label Text="Sign Up" FontSize="14" TextColor="{StaticResource TextLight}" Margin="20,0,0,0"
                                     IsVisible="{Binding IsSignUp, Converter={StaticResource InvertedBoolConverter}}" />
                              <Label Text="Sign In" FontSize="14" TextColor="{StaticResource TextLight}" Margin="20,0,0,0"
                                     IsVisible="{Binding IsSignUp}" />
                     </HorizontalStackLayout>

                     <!-- Sign Up Only Fields -->
                     <Border StrokeShape="RoundRectangle 8" Stroke="{StaticResource CardBg}" BackgroundColor="{StaticResource CardBg}" Padding="12"
                             IsVisible="{Binding IsSignUp}">
                            <Entry Placeholder="First Name"
                                      PlaceholderColor="{StaticResource TextLight}"
                                      TextColor="#000000"
                                      FontSize="14"
                                      Text="{Binding FirstName}" />
                     </Border>

                     <Border StrokeShape="RoundRectangle 8" Stroke="{StaticResource CardBg}" BackgroundColor="{StaticResource CardBg}" Padding="12"
                             IsVisible="{Binding IsSignUp}">
                            <Entry Placeholder="Last Name"
                                      PlaceholderColor="{StaticResource TextLight}"
                                      TextColor="#000000"
                                      FontSize="14"
                                      Text="{Binding LastName}" />
                     </Border>

                     <Border StrokeShape="RoundRectangle 8" Stroke="{StaticResource CardBg}" BackgroundColor="{StaticResource CardBg}" Padding="12"
                             IsVisible="{Binding IsSignUp}">
                            <Entry Placeholder="Phone Number (Optional)"
                                      PlaceholderColor="{StaticResource TextLight}"
                                      TextColor="#000000"
                                      Keyboard="Telephone"
                                      FontSize="14"
                                      Text="{Binding PhoneNumber}" />
                     </Border>

                     <!-- Date of Birth Picker -->
                     <VerticalStackLayout IsVisible="{Binding IsSignUp}" Spacing="8">
                            <Label Text="Date of Birth" FontSize="12" TextColor="{StaticResource TextLight}" Margin="4,0,0,0" />
                            <Border StrokeShape="RoundRectangle 8" Stroke="{StaticResource CardBg}" BackgroundColor="{StaticResource CardBg}" Padding="0">
                                   <Grid ColumnDefinitions="*,40" Padding="12,0">
                                          <DatePicker Grid.Column="0" 
                                                      Date="{Binding DateOfBirth}"
                                                      FontSize="14"
                                                      TextColor="#000000"
                                                      Format="MMM dd, yyyy"
                                                      MaximumDate="{Binding MaxDateOfBirth}"
                                                      MinimumDate="{Binding MinDateOfBirth}" />
                                          <Label Grid.Column="1" Text="ðŸ“…" FontSize="18" VerticalOptions="Center" HorizontalOptions="Center" />
                                   </Grid>
                            </Border>
                     </VerticalStackLayout>

                     <!-- Email and Password Fields (Both Sign In and Sign Up) -->
                     <Border StrokeShape="RoundRectangle 8" Stroke="{StaticResource CardBg}" BackgroundColor="{StaticResource CardBg}" Padding="12">
                            <Entry Placeholder="Username"
                                      PlaceholderColor="{StaticResource TextLight}"
                                      TextColor="#000000"
                                      Keyboard="Email"
                                      FontSize="14"
                                      Text="{Binding Email}" />
                     </Border>

                     <Border StrokeShape="RoundRectangle 8" Stroke="{StaticResource CardBg}" BackgroundColor="{StaticResource CardBg}" Padding="12">
                            <Entry Placeholder="Password"
                                      PlaceholderColor="{StaticResource TextLight}"
                                     TextColor="#000000"
                                     IsPassword="True"
                                     FontSize="14"
                                     Text="{Binding Password}" />
                     </Border>

                          <Label Text="{Binding ErrorMessage}"
                                 TextColor="{StaticResource ErrorRed}"
                                 FontSize="12"
                                 IsVisible="{Binding ErrorMessage, Converter={StaticResource StringNullOrEmptyConverter}, ConverterParameter=True}"
                                 Margin="0,0,0,10" />

                     <Button Text="Sign In"
                                   BackgroundColor="{StaticResource AccentOrange}"
                                   TextColor="{StaticResource DarkBg}"
                                   CornerRadius="8"
                                   FontAttributes="Bold"
                                FontSize="14"
                                Padding="12,10"
                                Command="{Binding SignInCommand}"
                                IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
                                IsVisible="{Binding IsSignUp, Converter={StaticResource InvertedBoolConverter}}" />

                     <Button Text="Create Account"
                                   BackgroundColor="{StaticResource AccentOrange}"
                                   TextColor="{StaticResource DarkBg}"
                                   CornerRadius="8"
                                   FontAttributes="Bold"
                                FontSize="14"
                                Padding="12,10"
                                Command="{Binding SignUpCommand}"
                                IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
                                IsVisible="{Binding IsSignUp}" />

                          <ActivityIndicator IsRunning="{Binding IsLoading}"
                                             IsVisible="{Binding IsLoading}"
                                             Color="{StaticResource AccentOrange}"
                                             Margin="0,10,0,10" />

                     <Button Text="Sign In with Google"
                                   BackgroundColor="#FFFFFF"
                                   TextColor="{StaticResource DarkBg}"
                                   CornerRadius="8"
                                   FontAttributes="Bold"
                                FontSize="14"
                                Padding="12,10"
                                Margin="0,10,0,0"
                                Command="{Binding GoogleSignInCommand}"
                                IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}" />

                         <Button BackgroundColor="Transparent"
                                TextColor="{StaticResource AccentOrange}"
                                FontSize="12"
                                Padding="10"
                                Margin="0,10,0,0"
                                Command="{Binding ToggleSignUpCommand}">
                            <Button.Triggers>
                                <DataTrigger TargetType="Button" Binding="{Binding IsSignUp}" Value="True">
                                    <Setter Property="Text" Value="Already have an account? Sign In" />
                                </DataTrigger>
                                <DataTrigger TargetType="Button" Binding="{Binding IsSignUp}" Value="False">
                                    <Setter Property="Text" Value="Don't have an account? Sign Up" />
                                </DataTrigger>
                            </Button.Triggers>
                         </Button>

                         <!-- Quick Dev Login Button -->
                         <Button Text="Quick Login (Dev)"
                                BackgroundColor="{StaticResource CardBg}"
                                TextColor="{StaticResource TextLight}"
                                FontSize="10"
                                Padding="8"
                                Margin="0,10,0,0"
                                Command="{Binding QuickLoginCommand}"
                                IsVisible="{Binding IsSignUp, Converter={StaticResource InvertedBoolConverter}}" />

              </VerticalStackLayout>
       </ScrollView>
       </Grid>

</ContentPage>
