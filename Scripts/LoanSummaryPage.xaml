<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:views="clr-namespace:Lender.Views"
             x:Class="Lender.LoanSummaryPage"
             Title="Loan Summary"
             BackgroundColor="#0A1929"
             Padding="0"
             SafeAreaEdges="None">
    <ContentPage.Resources>
        <ResourceDictionary Source="Resources/Styles/Colors.xaml" />
    </ContentPage.Resources>
    <Grid RowDefinitions="*,Auto" BackgroundColor="#0A1929">
        <!-- Main Content -->
        <ScrollView Grid.Row="0" Padding="16">
            <VerticalStackLayout Spacing="16">
                <!-- Header -->
                <HorizontalStackLayout Spacing="10" Padding="0,10,0,0">
                    <Button Text="&lt;"
                            Command="{Binding BackCommand}"
                            BackgroundColor="Transparent"
                            TextColor="#FF9F43"
                            FontSize="28"
                            WidthRequest="44"
                            HeightRequest="44"
                            CornerRadius="22"
                            Padding="0" />
                    <Label Text="Loan Summary"
                           FontSize="24"
                           FontAttributes="Bold"
                           TextColor="White"
                           VerticalTextAlignment="Center" />
                </HorizontalStackLayout>

                <!-- Summary Card -->
                <Frame CornerRadius="12" BackgroundColor="#132F4C" Padding="16" HasShadow="False">
                    <VerticalStackLayout Spacing="16">
                        <Label Text="Loan Details" FontSize="18" FontAttributes="Bold" TextColor="White" />
                        
                        <!-- Mode -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="Type:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding Mode}" TextColor="White" FontAttributes="Bold" />
                        </HorizontalStackLayout>

                        <!-- Amount -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="Amount:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding AmountText, StringFormat='${0}'}" TextColor="#FF9F43" FontSize="16" FontAttributes="Bold" />
                        </HorizontalStackLayout>

                        <!-- Payback -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="Payback:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding PaybackDisplay}" TextColor="White" />
                        </HorizontalStackLayout>

                        <!-- Interest Type -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="Interest Type:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding InterestTypeDisplay}" TextColor="White" />
                        </HorizontalStackLayout>

                        <!-- Interest Rate (if applicable) -->
                        <HorizontalStackLayout Spacing="8" IsVisible="{Binding IsInterestDetailsVisible}">
                            <Label Text="Interest Rate:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding InterestRate, StringFormat='{0}%'}" TextColor="White" />
                        </HorizontalStackLayout>

                        <!-- Payment Frequency -->
                        <HorizontalStackLayout Spacing="8" IsVisible="{Binding IsPaymentFrequencyVisible}">
                            <Label Text="Payment Frequency:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding SelectedPaymentFrequencyLabel}" TextColor="White" />
                        </HorizontalStackLayout>

                        <!-- Collateral -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="Collateral:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding CollateralDisplay}" TextColor="White" />
                        </HorizontalStackLayout>

                        <BoxView HeightRequest="1" BackgroundColor="#B0BEC5" Opacity="0.3" Margin="0,8" />

                        <!-- Calculated Values -->
                        <Label Text="Payment Plan" FontSize="18" FontAttributes="Bold" TextColor="White" />

                        <HorizontalStackLayout Spacing="8">
                            <Label Text="Total Payments:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding TotalPayments}" TextColor="White" FontAttributes="Bold" />
                        </HorizontalStackLayout>

                        <HorizontalStackLayout Spacing="8">
                            <Label Text="Payment Amount:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding PeriodicPayment, StringFormat='${0:F2}'}" TextColor="#1ABC9C" FontSize="16" FontAttributes="Bold" />
                        </HorizontalStackLayout>

                        <HorizontalStackLayout Spacing="8">
                            <Label Text="Total Interest:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding TotalInterest, StringFormat='${0:F2}'}" TextColor="White" />
                        </HorizontalStackLayout>

                        <HorizontalStackLayout Spacing="8">
                            <Label Text="Total Amount:" TextColor="#B0BEC5" WidthRequest="120" />
                            <Label Text="{Binding TotalPayment, StringFormat='${0:F2}'}" TextColor="#FF9F43" FontSize="18" FontAttributes="Bold" />
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </Frame>

                <!-- Continue Button -->
                <Button Text="Continue" 
                        Command="{Binding ContinueToRequesterInfoCommand}"
                        BackgroundColor="#1ABC9C"
                        TextColor="White"
                        FontAttributes="Bold"
                        CornerRadius="12" 
                        Padding="16,12"
                        Margin="0,16,0,16" />
            </VerticalStackLayout>
        </ScrollView>

        <!-- Bottom Navigation -->
        <views:BottomNavView Grid.Row="1" SelectedTab="Loans" />
    </Grid>
</ContentPage>
